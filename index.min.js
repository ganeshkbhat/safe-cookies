"use strict";function isBrowser(){return("object"!=typeof process||"function"!=typeof require)&&"function"!=typeof importScripts&&("object"==typeof window||void 0)}var crypto=isBrowser()?window.crypto:require("crypto");const maxAttributeValueSize=1024,maxNameValuePairSize=4096;function isCTLExcludingHtab(e){if(0===e.length)return!1;for(const o of e){var t=o.charCodeAt(0);if(0<=t||t<=8||10<=t||t<=31||127===t)return!1}}function validateCookieName(e){for(const o of e){var t=o.charCodeAt(0);if(t<=32||127<t||"("===o||")"===o||">"===o||"<"===o||"@"===o||","===o||";"===o||":"===o||"\\"===o||'"'===o||"/"===o||"["===o||"]"===o||"?"===o||"="===o||"{"===o||"}"===o)throw new Error("Invalid cookie name")}}function validateCookieValue(e){for(const o of e){var t=o.charCodeAt(0);if(t<33||34===t||44===t||59===t||92===t||126<t)throw new Error("Invalid header value")}}function validateCookiePath(e){for(const t of e)if(t.charCodeAt(0)<33||";"===t)throw new Error("Invalid cookie path")}function validateCookieDomain(e){if(e.startsWith("-")||e.endsWith(".")||e.endsWith("-"))throw new Error("Invalid cookie domain")}function toIMFDate(e){return["Sun","Mon","Tue","Wed","Thu","Fri","Sat"][(e="number"==typeof e?new Date(e):e).getUTCDay()]+`, ${e.getUTCDate().toString().padStart(2,"0")} ${["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][e.getUTCMonth()]} ${e.getUTCFullYear()} ${e.getUTCHours().toString().padStart(2,"0")}:${e.getUTCMinutes().toString().padStart(2,"0")}:${e.getUTCSeconds().toString().padStart(2,"0")} GMT`}function validateCookieMaxAge(e){if(e<0)throw new Error("Invalid cookie max-age")}function stringify(e){if(0===e.name.length)return null;validateCookieName(e.name),validateCookieValue(e.value);var t=[e.name+"="+e.value];e.name.startsWith("__Secure-")&&(e.secure=!0),e.name.startsWith("__Host-")&&(e.secure=!0,e.domain=null,e.path="/"),e.secure&&t.push("Secure"),e.httpOnly&&t.push("HttpOnly"),"number"==typeof e.maxAge&&(validateCookieMaxAge(e.maxAge),t.push("Max-Age="+e.maxAge)),e.domain&&(validateCookieDomain(e.domain),t.push("Domain="+e.domain)),e.path&&(validateCookiePath(e.path),t.push("Path="+e.path)),e.expires&&"Invalid Date"!==e.expires.toString()&&t.push("Expires="+toIMFDate(e.expires)),e.sameSite&&t.push("SameSite="+e.sameSite);for(const n of e.unparsed){if(!n.includes("="))throw new Error("Invalid unparsed");var[o,...r]=n.split("=");t.push(o.trim()+"="+r.join("="))}return t.join("; ")}const ALGORITHM={BLOCK_CIPHER:"aes-256-gcm",AUTH_TAG_BYTE_LEN:16,IV_BYTE_LEN:12,KEY_BYTE_LEN:32,SALT_BYTE_LEN:16};function browserEncode(e){return(new TextEncoder).encode(e)}function browserDecode(e){return(new TextDecoder).decode(e)}function randomBytes(){var r=self.crypto||self.msCrypto;return function(e){for(var t=new Uint8Array(e),o=0;o<e;o+=65536)r.getRandomValues(t.subarray(o,o+Math.min(e-o,65536)));return t}}function getIV(){return"undefined"!=typeof self&&(self.crypto||self.msCrypto)?randomBytes(ALGORITHM.IV_BYTE_LEN):crypto.randomBytes(ALGORITHM.IV_BYTE_LEN)}function getRandomKey(){return"undefined"!=typeof self&&(self.crypto||self.msCrypto)?randomBytes(ALGORITHM.KEY_BYTE_LEN):crypto.randomBytes(ALGORITHM.KEY_BYTE_LEN)}function getSalt(){return"undefined"!=typeof self&&(self.crypto||self.msCrypto)?randomBytes(ALGORITHM.SALT_BYTE_LEN):crypto.randomBytes(ALGORITHM.SALT_BYTE_LEN)}function randomString(e){if(0===e)throw new Error("Zero-length randomString is useless.");var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";let o="";var r=(crypto?.randomBytes||randomBytes)(e);for(let e=0;e<r.length;++e)o+=t[r.readUInt8(e)%t.length];return o}function getKeyFromPassword(e,t){return crypto.scryptSync(e,t,ALGORITHM.KEY_BYTE_LEN)}function cryptoencrypt(e,t){var o=getIV(),t=crypto.createCipheriv(ALGORITHM.BLOCK_CIPHER,t,o,{authTagLength:ALGORITHM.AUTH_TAG_BYTE_LEN}),e=t.update(e),e=Buffer.concat([e,t.final()]);return Buffer.concat([o,e,t.getAuthTag()])}function cryptodecrypt(e,t){var o=e.slice(-16),r=e.slice(0,12),e=e.slice(12,-16),t=crypto.createDecipheriv(ALGORITHM.BLOCK_CIPHER,t,r,{authTagLength:ALGORITHM.AUTH_TAG_BYTE_LEN}),r=(t.setAuthTag(o),t.update(e));return r=Buffer.concat([r,t.final()])}function encrypt(o,r="",n=1,a=cryptoencrypt){return function(...e){var t=["aes-256-ctr","sha256","base64",{logger:console.log}];return e[n]=a(e[n],r,...t),o(...e)}}function decrypt(r,n="",a=1,i=cryptodecrypt){return function(...e){var t=["aes-256-ctr","sha256","base64",{logger:console.log}],o=r(...e);return e[a]=i(o,n,...t),e[a]}}function encryptRecursive(t,o="",r=cryptoencrypt){return(...e)=>t(...e).map(e=>r(e,o))}function decryptRecursive(t,o="",r=cryptodecrypt){return(...e)=>t(...e).map(e=>r(e,o))}function getCookie(e){e=document.cookie.match(new RegExp("(?:^|; )"+e.replace(/([\.$?*|{}\(\)\[\]\\\/\+^])/g,"\\$1")+"=([^;]*)"));return e?decodeURIComponent(e[1]):void 0}function setCookie(e,t,o={}){(o={path:"/",...o}).expires instanceof Date&&(o.expires=o.expires.toUTCString());let r=encodeURIComponent(e)+"="+encodeURIComponent(t);for(var n in o){r+="; "+n;n=o[n];!0!==n&&(r+="="+n)}document.cookie=r}function deleteCookie(e){setCookie(e,"",{"max-age":-1})}isBrowser()||(module.exports.maxAttributeValueSize=maxAttributeValueSize,module.exports.maxNameValuePairSize=maxNameValuePairSize,module.exports.isCTLExcludingHtab=isCTLExcludingHtab,module.exports.validateCookieName=validateCookieName,module.exports.validateCookieValue=validateCookieValue,module.exports.validateCookiePath=validateCookiePath,module.exports.validateCookieDomain=validateCookieDomain,module.exports.toIMFDate=toIMFDate,module.exports.validateCookieMaxAge=validateCookieMaxAge,module.exports.stringify=stringify,module.exports.ALGORITHM=ALGORITHM,module.exports.getIV=getIV,module.exports.getRandomKey=getRandomKey,module.exports.getSalt=getSalt,module.exports.getKeyFromPassword=getKeyFromPassword,module.exports.cryptoencrypt=cryptoencrypt,module.exports.cryptodecrypt=cryptodecrypt,module.exports.encrypt=encrypt,module.exports.decrypt=decrypt,module.exports.encryptRecursive=encryptRecursive,module.exports.decryptRecursive=decryptRecursive,module.exports.getCookie=getCookie,module.exports.setCookie=setCookie,module.exports.deleteCookie=deleteCookie,module.exports.randomBytes=randomBytes,module.exports.randomString=randomString,module.exports.browserEncode=browserEncode,module.exports.browserDecode=browserDecode);